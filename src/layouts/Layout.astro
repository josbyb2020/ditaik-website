---
import { ViewTransitions } from 'astro:transitions';
import '../styles/global.css';

interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="fr" class="scroll-smooth dark">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Ditaik - Expertise data et intelligence artificielle. Accélérez vos projets avec des spécialistes qualifiés." />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/x-icon" href="/assets/favicon_io/favicon.ico" />
		<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon_io/favicon-32x32.png" />
		<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon_io/favicon-16x16.png" />
		<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon_io/apple-touch-icon.png" />
		<link rel="manifest" href="/assets/favicon_io/site.webmanifest" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<ViewTransitions />
        <!-- Inline script to prevent flash -->
        <script is:inline>
            (function() {
                const theme = localStorage.getItem('theme');
                if (theme === 'light' || (!theme && window.matchMedia('(prefers-color-scheme: light)').matches)) {
                    document.documentElement.classList.remove('dark');
                } else {
                    document.documentElement.classList.add('dark');
                }
            })();
        </script>
	</head>
	<body class="antialiased overflow-x-hidden transition-colors duration-300">
		<!-- Skip to main content (keyboard a11y) -->
		<a href="#main-content" class="skip-link">
			Aller au contenu principal
		</a>
        <!-- Glassmorphism navbar -->
        <nav class="fixed top-0 left-0 right-0 z-50 backdrop-blur-md bg-white/50 dark:bg-slate-950/50 border-b border-slate-200 dark:border-white/10 transition-all duration-300">
            <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
                <a href="/" class="text-2xl font-bold tracking-tight z-50 text-slate-900 dark:text-white">
                    Ditaik<span class="text-electric-500">.</span>
                </a>

                <div class="hidden md:flex items-center gap-8">
                    <a href="/" class="text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white transition-colors">Accueil</a>
                    <a href="/services" class="text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white transition-colors">Services</a>
                    <a href="/freelance" class="text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white transition-colors">Freelances</a>
                    <a href="/about" class="text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white transition-colors">À propos</a>
                    
                    <!-- Theme toggle (desktop) -->
                    <button type="button" class="theme-toggle p-2 rounded-full text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors" aria-label="Changer le thème">
                        <svg id="sun-icon" class="w-5 h-5 hidden dark:block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                        </svg>
                        <svg id="moon-icon" class="w-5 h-5 block dark:hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
                        </svg>
                    </button>

                    <a href="/contact" class="px-5 py-2.5 rounded-full bg-slate-900 dark:bg-white text-white dark:text-slate-950 font-semibold text-sm hover:bg-electric-500 hover:text-white transition-all duration-300">
                        Contact
                    </a>
                </div>
                
                <!-- Mobile menu button -->
                <button id="mobile-menu-btn" class="md:hidden text-slate-900 dark:text-white z-50 relative" aria-label="Ouvrir le menu" aria-expanded="false" aria-controls="mobile-menu">
                   <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                    </svg>
                </button>
            </div>

            <!-- Mobile menu overlay -->
            <div id="mobile-menu" role="dialog" aria-label="Menu de navigation" class="fixed inset-0 bg-white/95 dark:bg-slate-950/95 backdrop-blur-3xl z-40 transform translate-x-full transition-transform duration-500 flex flex-col items-center justify-center gap-8 md:hidden">
                <a href="/" class="text-3xl font-light text-slate-900 dark:text-white hover:text-electric-500 transition-colors tracking-tight">Accueil</a>
                <a href="/services" class="text-3xl font-light text-slate-900 dark:text-white hover:text-electric-500 transition-colors tracking-tight">Services</a>
                <a href="/freelance" class="text-3xl font-light text-slate-900 dark:text-white hover:text-electric-500 transition-colors tracking-tight">Freelances</a>
                <a href="/about" class="text-3xl font-light text-slate-900 dark:text-white hover:text-electric-500 transition-colors tracking-tight">À propos</a>
                <a href="/contact" class="px-10 py-4 rounded-full bg-electric-500 text-white font-bold text-xl hover:bg-slate-900 dark:hover:bg-white dark:hover:text-slate-950 transition-all shadow-glow">
                    Contact
                </a>
                <!-- Theme toggle (mobile menu) -->
                <button type="button" class="theme-toggle p-3 rounded-full text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors mt-4" aria-label="Changer le thème">
                    <svg class="sun-icon w-6 h-6 hidden dark:block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                    </svg>
                    <svg class="moon-icon w-6 h-6 block dark:hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
                    </svg>
                </button>
            </div>
        </nav>

        <script>
            // Theme toggle (desktop + mobile menu)
            document.querySelectorAll('.theme-toggle').forEach((btn) => {
                btn.addEventListener('click', () => {
                    const isDark = document.documentElement.classList.toggle('dark');
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                });
            });

            // Listen for OS theme changes (e.g., iOS sunset auto-switch)
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                // Only auto-switch if user hasn't set a manual preference
                if (!localStorage.getItem('theme')) {
                    document.documentElement.classList.toggle('dark', e.matches);
                }
            });

            // Mobile menu logic
            const btn = document.getElementById('mobile-menu-btn');
            const menu = document.getElementById('mobile-menu');
            let isMenuOpen = false;

            function toggleMenu() {
                isMenuOpen = !isMenuOpen;
                const btnEl = document.getElementById('mobile-menu-btn');
                if (isMenuOpen) {
                    menu?.classList.remove('translate-x-full');
                    document.body.style.overflow = 'hidden';
                    btnEl?.setAttribute('aria-expanded', 'true');
                } else {
                    menu?.classList.add('translate-x-full');
                    document.body.style.overflow = '';
                    btnEl?.setAttribute('aria-expanded', 'false');
                }
            }

            btn?.addEventListener('click', toggleMenu);

            // Close menu when a nav link is clicked (for same-page or before transition)
            document.getElementById('mobile-menu')?.querySelectorAll('a').forEach((link) => {
                link.addEventListener('click', () => { if (isMenuOpen) toggleMenu(); });
            });

            document.addEventListener('astro:after-swap', () => {
                isMenuOpen = false;
                menu?.classList.add('translate-x-full');
                document.body.style.overflow = '';
                document.getElementById('mobile-menu-btn')?.setAttribute('aria-expanded', 'false');
            });
        </script>

		<main id="main-content" class="pt-20 relative z-10" tabindex="-1">
			<slot />
		</main>

        <footer class="border-t border-slate-200 dark:border-white/10 bg-slate-50 dark:bg-slate-950 mt-24 py-12 relative z-10">
            <div class="max-w-7xl mx-auto px-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-12">
                    <div class="col-span-1 md:col-span-2">
                         <a href="/" class="text-2xl font-bold tracking-tight block mb-4 text-slate-900 dark:text-white">
                            Ditaik<span class="text-electric-500">.</span>
                        </a>
                        <p class="text-slate-600 dark:text-slate-400 max-w-sm">
                            Connectez-vous avec des experts en data et IA pour propulser votre entreprise.
                        </p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-slate-900 dark:text-white mb-4">Navigation</h4>
                        <ul class="space-y-2">
                             <li><a href="/" class="text-slate-600 dark:text-slate-400 hover:text-electric-500 transition-colors">Accueil</a></li>
                             <li><a href="/services" class="text-slate-600 dark:text-slate-400 hover:text-electric-500 transition-colors">Services</a></li>
                             <li><a href="/freelance" class="text-slate-600 dark:text-slate-400 hover:text-electric-500 transition-colors">Freelances</a></li>
                             <li><a href="/about" class="text-slate-600 dark:text-slate-400 hover:text-electric-500 transition-colors">À propos</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-slate-900 dark:text-white mb-4">Contact</h4>
                         <ul class="space-y-2">
                             <li><a href="mailto:contact@ditaik.org" class="text-slate-600 dark:text-slate-400 hover:text-electric-500 transition-colors">contact@ditaik.org</a></li>
                             <li><span class="text-slate-600 dark:text-slate-400">Paris, France</span></li>
                        </ul>
                    </div>
                </div>
                <div class="pt-8 border-t border-slate-200 dark:border-white/5 flex flex-col md:flex-row justify-between items-center gap-4">
                    <p class="text-slate-500 text-sm">© 2025 Ditaik. Tous droits réservés.</p>
                </div>
            </div>
            
            <!-- Footer ambient glow (only visible in dark mode) -->
            <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-[500px] h-[300px] bg-electric-500/10 blur-[100px] rounded-full pointer-events-none hidden dark:block"></div>
        </footer>
	</body>
</html>
